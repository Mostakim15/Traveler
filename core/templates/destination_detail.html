{% extends "base.html" %}
{% load i18n %}

{% block content %}


<h2 class="text-xl font-bold mb-4 mt-8" style="color:#94cef2">{% trans "Transport Options" %}</h2>
<div class="space-y-2 mb-6">
  {% if transports %}
    {% for transport in transports %}
      <div class="bg-gray-50 p-3 rounded shadow flex justify-between items-center">
        <span class="font-semibold">{{ transport.vehicle_name }}</span>
        {% if transport.dynamic_fare != transport.base_fare %}
          <span class="text-blue-700 font-bold">‡ß≥ {{ transport.dynamic_fare|floatformat:2 }} <span class="text-xs text-gray-500">{% trans "(est. for your location)" %}</span></span>
        {% else %}
          <span class="text-blue-700 font-bold">‡ß≥ {{ transport.base_fare|floatformat:2 }}</span>
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
  <p>{% trans "No transport options available for this destination." %}</p>
  {% endif %}
</div>

<h2 class="text-xl font-bold mb-4" style="color:#94cef2">{% trans "Hotels in this Destination" %}</h2>
<div class="space-y-2 mb-6">
  {% if hotels %}
    {% for hotel in hotels %}
      <div class="bg-white p-4 rounded shadow flex flex-col md:flex-row md:items-center md:justify-between">
        <div>
          <span class="font-semibold text-blue-700">{{ hotel.name }}</span>
          <span class="text-gray-500 text-sm ml-2">{{ hotel.address }}</span>
        </div>
  <span class="text-blue-600 font-bold">‡ß≥ {{ hotel.price_per_night|floatformat:2 }} <span class="text-xs text-gray-500">{% trans "per night" %}</span></span>
      </div>
    {% endfor %}
  {% else %}
  <p>{% trans "No hotels found for this destination." %}</p>
  {% endif %}
</div>

<h1 class="text-3xl font-bold mb-4">{{ destination.name }}</h1>
<p class="mb-4">{{ destination.description }}</p>
<p class="mb-4"><strong>{% trans "Location:" %}</strong> {{ destination.city }}, {{ destination.country }}</p>
{% if distance %}
  <p class="mb-4 text-blue-600 font-semibold">üìç {% trans "Distance from you:" %} {{ distance }} km</p>
{% endif %}

<div id="map" class="w-full h-96 mb-6"></div>

<h2 class="text-xl font-bold mb-4" style="color:#94cef2">{% trans "Reviews" %}</h2>
<div class="space-y-4">
  {% for review in reviews %}
    <div class="bg-white p-4 rounded shadow">
      <p>{{ review.comment }}</p>
      <span class="text-sm text-gray-600">‚≠ê {{ review.rating }} - {{ review.user.username }}</span>
    </div>
  {% empty %}
  <p>{% trans "No reviews yet." %}</p>
  {% endfor %}
</div>

{% if user.is_authenticated %}
  <form method="post" class="mt-6 bg-white p-4 rounded shadow">
    {% csrf_token %}
  <textarea name="comment" class="w-full border p-2 mb-4" placeholder="{% trans 'Write a review...' %}"></textarea>
    <select name="rating" class="border p-2 mb-4">
      {% for i in "12345" %}
        <option value="{{ i }}">{{ i }}</option>
      {% endfor %}
    </select>
  <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">{% trans "Submit Review" %}</button>
  </form>
{% else %}
  <p class="mt-4">{% trans "You must" %} <a href="{% url 'login' %}" class="text-blue-500 underline">{% trans "login" %}</a> {% trans "to add a review." %}</p>
{% endif %}

<script src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API_KEY }}"></script>
<script>
  function initMap() {
    const loc = { lat: {{ destination.latitude }}, lng: {{ destination.longitude }} };
    const map = new google.maps.Map(document.getElementById("map"), { zoom: 12, center: loc });
    new google.maps.Marker({ position: loc, map, title: "{{ destination.name }}" });
  }
  window.onload = initMap;
</script>

{% endblock %}
