{% extends "base.html" %}
{% load i18n %}

{% block content %}
<section class="my-8">
    <h2 class="text-3xl font-extrabold mb-6 text-center tracking-tight" style="color:#94cef2">Tourist Places</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 mb-10">
        {% for place in places %}
            <a href="{% url 'tourist_place_detail' place.id %}" class="group flex justify-center">
                <div class="bg-white rounded-2xl shadow-lg p-4 flex flex-col h-[420px] w-full max-w-xs border border-blue-100 hover:border-blue-400 hover:shadow-2xl transition-all duration-200 relative overflow-hidden">
                    {% if place.image %}
                        <img src="{{ place.image.url }}" alt="{{ place.name }}" class="w-full h-44 object-cover rounded-xl mb-3 group-hover:scale-105 transition-transform duration-200">
                    {% else %}
                        <div class="w-full h-44 flex items-center justify-center bg-blue-50 rounded-xl mb-3 text-blue-300 text-6xl">üó∫Ô∏è</div>
                    {% endif %}
                    <h3 class="text-lg font-bold text-blue-700 mb-1 truncate">{{ place.name }}</h3>
                    <p class="text-gray-600 text-sm flex-grow">{{ place.description|truncatewords:20 }}</p>
                    <div class="text-gray-500 text-xs mt-1">{{ place.city }}, {{ place.country }}</div>
                    <span class="absolute top-3 right-3 bg-blue-100 text-blue-600 text-xs font-semibold px-3 py-1 rounded-full shadow group-hover:bg-blue-500 group-hover:text-white transition">Tourist Place</span>
                    <span class="mt-3 text-blue-500 font-semibold text-sm group-hover:underline">View Details ‚Üí</span>
                </div>
            </a>
        {% empty %}
            <p class="col-span-3 text-center text-gray-500">No tourist places found.</p>
        {% endfor %}
    </div>
    <div id="tourist-map" class="w-full h-96 rounded-2xl shadow mb-8"></div>
</section>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var map = L.map('tourist-map').setView([23.8103, 90.4125], 6);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '\u00a9 OpenStreetMap contributors'
        }).addTo(map);
        {% for place in places %}
            {% if place.latitude and place.longitude %}
                L.marker([{{ place.latitude }}, {{ place.longitude }}]).addTo(map)
                    .bindPopup('<strong>{{ place.name|escapejs }}</strong><br>{{ place.city }}, {{ place.country }}<br>{{ place.description|truncatewords:12|escapejs }}');
            {% endif %}
        {% endfor %}
    });
</script>
{% endblock %}